(this["webpackJsonpprojectx-web"]=this["webpackJsonpprojectx-web"]||[]).push([[0],{10:function(e,t,o){},12:function(e,t,o){"use strict";o.r(t);var n=o(1),r=o.n(n),c=o(3),s=o.n(c),a=(o(9),o.p+"static/media/logo.6ce24c58.svg"),i=(o(10),o(0));var d=function(){return Object(i.jsx)("div",{className:"App",children:Object(i.jsxs)("header",{className:"App-header",children:[Object(i.jsx)("img",{src:a,className:"App-logo",alt:"logo"}),Object(i.jsxs)("p",{children:["Edit ",Object(i.jsx)("code",{children:"src/App.js"})," and save to reload."]}),Object(i.jsx)("a",{className:"App-link",href:"https://reactjs.org",target:"_blank",rel:"noopener noreferrer",children:"Learn React"})]})})},u=function(e){e&&e instanceof Function&&o.e(3).then(o.bind(null,13)).then((function(t){var o=t.getCLS,n=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;o(e),n(e),r(e),c(e),s(e)}))},l=o(2);function b(e,t,o,n){var r;n&&(r=JSON.stringify(n));var c=localStorage.getItem("token");console.log("Token Passing ",c);var s=new XMLHttpRequest,a="https://projectxweb1.herokuapp.com/api".concat(t);console.log(a,"URL"),s.responseType="json";var i=function(e){var t=null;if(document.cookie&&""!==document.cookie)for(var o=document.cookie.split(";"),n=0;n<o.length;n++){var r=o[n].trim();if(r.substring(0,e.length+1)===e+"="){t=decodeURIComponent(r.substring(e.length+1));break}}return t}("csrftoken");s.open(e,a),s.setRequestHeader("Content-Type","application/json"),c&&s.setRequestHeader("Authorization","Token ".concat(c)),i&&(s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.setRequestHeader("X-CSRFToken",i)),s.onload=function(){if(403===s.status){var e=s.response.detail;console.log(e),"Authentication credentials were not provided."===e&&-1===window.location.href.indexOf("login")&&(window.location.href="/login?showLoginRequired=true")}o(s.response,s.status)},s.onerror=function(e){console.log("error",e),o({message:"The request was an error"},400)},s.send(r)}function j(e,t){var o;e&&(o=JSON.stringify(e));var n=new XMLHttpRequest;n.responseType="json";var r=function(e){var t=null;if(document.cookie&&""!==document.cookie)for(var o=document.cookie.split(";"),n=0;n<o.length;n++){var r=o[n].trim();if(r.substring(0,e.length+1)===e+"="){t=decodeURIComponent(r.substring(e.length+1));break}}return t}("csrftoken");n.open("POST","https://projectxweb1.herokuapp.com/auth/"),n.setRequestHeader("Content-Type","application/json"),r&&(n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.setRequestHeader("X-CSRFToken",r)),n.onload=function(){if(403===n.status){var e=n.response.detail;console.log(e)}t(n.response,n.status)},n.onerror=function(e){console.log("error",e),t({message:"The request was an error"},400)},n.send(o)}function f(e,t,o){b("POST","/books/cart/",o,{action:t,id:e})}function O(e){b("GET","/books/cart/",e)}function m(e){var t=e.book,o=e.index,r=e.isDetail,c=e.inCart,s=e.onRemove,a=e.orderid,d=Object(n.useState)(e.buttonname?e.buttonname:null),u=Object(l.a)(d,2),j=u[0],O=u[1],m=Object(n.useState)(e.className?e.className:null),g=Object(l.a)(m,2),p=g[0],v=g[1],h=function(e,t){console.log("Add To Cart ",e,t),201===t&&("Add To Cart"===j?(O("Remove"),v("btn btn-danger")):"Remove"===j&&(!0===c?s(o):(O("Add To Cart"),v("btn btn-primary"))))},k=function(e,t){console.log("BUY ",e,t)},x=function(e,t){console.log("Cart Buy All",e,t),console.log("Buy All Successfull ")},y=function(e,t){console.log(e,t),"Book Not Delivered"===e.detail?alert("Book Not Delivered"):(v("btn btn-secondary disabled"),O("Book Processing for Return"))};return Object(i.jsx)("button",{className:p,onClick:function(o){var n,c,s=j;o.preventDefault(),o.stopPropagation(),"Add To Cart"===j?(s="Add",f(t.id,s,h)):"Remove"===j?(s="Remove",f(t.id,s,h)):"Buy"===j?r?(n=t.name,c=k,b("POST","/books/".concat(n,"/"),c,{action:"Buy"})):window.location.href="".concat(t.name,"/detail/"):"Buy All"===j?function(e,t){var o=[];e.forEach((function(e){o.push({id:e})})),b("POST","/books/cart/",t,{action:"Buy",detail:o})}(e.cartbooks,x):"Return Book"===j&&(!function(e,t){var o={action:"Return",detail:[{orderid:e}]};console.log(o,"Data"),b("POST","/books/owned/",t,o)}(a,y),console.log(a,"order ID OnClick"))},children:j})}function g(e){var t=e.book,o=e.index,r=e.className,c=e.isDetail,s=e.inCart,a=e.onRemove,d=e.owned,u=e.expiry,b=e.orderid,j=e.ordered,f=e.deliveryDate,g=Object(n.useState)(d?u?"btn btn-secondary disabled":"btn btn-danger":j?"btn btn-danger disabled":"btn btn-primary"),p=Object(l.a)(g,2),v=p[0],h=p[1],k=Object(n.useState)(d?u?"Book Processing for Return":"Return Book":j?"Estimated Delivery Date : ".concat(f):"Add To Cart"),x=Object(l.a)(k,2),y=x[0],R=x[1],S=Object(n.useState)(!0),w=Object(l.a)(S,2),C=w[0],T=w[1],B=function(e,o){403===o||e.usercart_set.forEach((function(e){e.book.id===t.id&&(h("btn btn-danger"),R("Remove"))}));T(!1)};return Object(n.useEffect)((function(){O(B)}),[]),!0===C?"":Object(i.jsx)("div",{className:"".concat(r," mt-3"),children:Object(i.jsxs)("div",{class:"card h-100",style:{width:"18rem"},children:[Object(i.jsx)("img",{class:"card-img-top",src:"...",alt:"Card image cap"}),Object(i.jsxs)("div",{class:"card-body",children:[Object(i.jsx)("h5",{class:"card-title",children:t.name}),Object(i.jsxs)("p",{class:"card-text",children:[t.price," ",t.type]}),!d&&!j&&Object(i.jsx)(m,{buttonname:"Buy",className:"btn btn-primary",book:t,isDetail:c}),Object(i.jsx)(m,{buttonname:y,className:v,book:t,inCart:s,onRemove:function(e){a(e)},index:o,orderid:b})]})]})})}function p(e,t){var o;e&&(o=JSON.stringify(e));var n=new XMLHttpRequest;n.responseType="json";var r=function(e){var t=null;if(document.cookie&&""!==document.cookie)for(var o=document.cookie.split(";"),n=0;n<o.length;n++){var r=o[n].trim();if(r.substring(0,e.length+1)===e+"="){t=decodeURIComponent(r.substring(e.length+1));break}}return t}("csrftoken");n.open("POST","http://127.0.0.1:8000/api/books/users"),n.setRequestHeader("Content-Type","application/json"),r&&(n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.setRequestHeader("X-CSRFToken",r)),n.onload=function(){if(403===n.status){var e=n.response.detail;console.log(e)}t(n.response,n.status)},n.onerror=function(e){console.log("error",e),t({message:"The request was an error"},400)},n.send(o)}function v(e){var t=Object(n.useState)(""),o=Object(l.a)(t,2),r=o[0],c=o[1],s=Object(n.useState)(""),a=Object(l.a)(s,2),d=a[0],u=a[1],b={username:r,password:d},f=function(e,t){400===t?alert("Wrong Credentials"):200===t&&(console.log(e.token,t),localStorage.setItem("token","".concat(e.token)),window.location.href="/")},O=function(e,t){console.log("Register ",e,t),200===t&&j(b,f),"A user with that username already exists."===e.username[0]&&alert("User Already Exists")},m=function(e){"username"===e.target.name?c(e.target.value):u(e.target.value)};return Object(i.jsxs)("div",{children:[Object(i.jsx)("h1",{children:"Login User Form"}),Object(i.jsxs)("label",{children:["Username :",Object(i.jsx)("input",{type:"text",name:"username",value:b.username,onChange:m})]}),Object(i.jsxs)("label",{children:["Password :",Object(i.jsx)("input",{type:"password",name:"password",value:b.password,onChange:m})]}),Object(i.jsx)("button",{onClick:function(e){j(b,f)},children:"Login"}),Object(i.jsx)("button",{onClick:function(e){p(b,O)},children:"Register"})]})}var h=document.getElementById("root");h&&s.a.render(Object(i.jsx)(d,{}),h);var k=r.a.createElement,x=document.getElementById("books");x&&s.a.render(k((function(e){var t=Object(n.useState)([]),o=Object(l.a)(t,2),c=o[0],s=o[1],a=Object(n.useState)(!0),d=Object(l.a)(a,2),u=d[0],j=d[1],f=function(e,t){console.log("response",e,t),s(e),j(!1)};return Object(n.useEffect)((function(){b("GET","/books/",f)}),[]),!0===u?"Loading":Object(i.jsx)(r.a.Fragment,{children:c.map((function(e,t){return Object(i.jsx)(g,{book:e},"".concat(t,"-{item.id}"))}))})}),x.dataset),x);var y=document.getElementById("bookdetail");y&&s.a.render(k((function(e){var t=Object(n.useState)(null),o=Object(l.a)(t,2),r=o[0],c=o[1],s=Object(n.useState)(!0),a=Object(l.a)(s,2),d=a[0],u=a[1],j=function(e,t){console.log("Book Detail Lookup",e,t),c(e[0]),u(!1)};return Object(n.useEffect)((function(){var t,o;t=e.bookname,o=j,b("GET","/books/".concat(t,"/detail"),o)}),[]),!0===d?"":Object(i.jsx)(g,{book:r,isDetail:!0})}),y.dataset),y);var R=document.getElementById("usercart");R&&s.a.render(k((function(e){var t=Object(n.useState)([]),o=Object(l.a)(t,2),r=o[0],c=o[1],s=Object(n.useState)(!0),a=Object(l.a)(s,2),d=a[0],u=a[1],b=0;Object(n.useEffect)((function(){O(j)}),[]);var j=function(e,t){console.log("Cart Lookup ",e.usercart_set,t),c(e.usercart_set),u(!1)},f=function(e){c(r.filter((function(t){return r.indexOf(t)!==e})))},p=r.map((function(e,t){return console.log(e.book.price),b+=e.book.price,e.book.id}));return d?"":0===p.length?Object(i.jsx)("div",{className:"text-muted",children:"Cart Is Empty"}):Object(i.jsxs)("div",{children:[r.map((function(e,t){return Object(i.jsx)(g,{book:e.book,index:t,inCart:!0,onRemove:f},t)})),0!==p.length&&Object(i.jsx)(m,{buttonname:"Buy All",className:"btn btn-primary",cartbooks:p}),0!==p.length&&Object(i.jsxs)("div",{children:["Total Cost ",b]})]})}),R.dataset),R);var S=document.getElementById("ownedBooks");S&&s.a.render(k((function(e){var t=Object(n.useState)([]),o=Object(l.a)(t,2),r=o[0],c=o[1],s=Object(n.useState)(!0),a=Object(l.a)(s,2),d=a[0],u=a[1];Object(n.useEffect)((function(){b("GET","/books/owned/",j),u(!1)}),[]);var j=function(e,t){c(e),console.log(e),console.log("order",r)};return d?"Loading":Object(i.jsxs)("div",{children:[" ",r.map((function(e,t){return Object(i.jsxs)("div",{className:"border border-secondary mt-3",children:[Object(i.jsxs)("div",{children:["Order Id : ",e.orderid]}),Object(i.jsx)(g,{book:e.book,owned:!0,expiry:e.expiry,orderid:e.orderid},t),Object(i.jsxs)("div",{children:["Order Duration :",e.duration]}),Object(i.jsxs)("div",{children:["OwnerFrom : ",e.ownerfrom]}),Object(i.jsxs)("div",{children:["Book Expiry : ",e.expiry]}),Object(i.jsxs)("div",{children:["Book Return Amount : ",e.returnamount]}),Object(i.jsxs)("div",{children:["Boom Return Date : ",e.returndate]})]})}))]})}),S.dataset),S);var w=document.getElementById("orderedBooks");w&&s.a.render(k((function(e){var t=Object(n.useState)([]),o=Object(l.a)(t,2),r=o[0],c=o[1],s=Object(n.useState)(!0),a=Object(l.a)(s,2),d=a[0],u=a[1],j=function(e,t){c(e),u(!1)};return Object(n.useEffect)((function(){b("GET","/books/ordered/",j)}),[]),d?"Loading":Object(i.jsx)("div",{children:r.map((function(e,t){return Object(i.jsxs)("div",{children:[Object(i.jsxs)("div",{children:["Order ID : ",e.id]}),Object(i.jsx)(g,{book:e.book,ordered:!0,deliveryDate:e.deliveryDate},t),Object(i.jsxs)("div",{children:["Delivery Date : ",e.deliveryDate," "]})]})}))})}),w.dataset),w);var C=document.getElementById("login");C&&s.a.render(k((function(e){var t=Object(n.useState)(""),o=Object(l.a)(t,2),r=(o[0],o[1]);return Object(i.jsx)(v,{userLogin:function(e){console.log(e),r(e)}})}),C.dataset),C);var T=document.getElementById("logout");T&&s.a.render(k((function(e){var t=Object(n.useState)("Are You Sure You Want to Logout ? "),o=Object(l.a)(t,2),r=o[0],c=o[1],s=Object(n.useState)(!0),a=Object(l.a)(s,2),d=a[0],u=a[1];return Object(n.useEffect)((function(){var e=localStorage.getItem("token");e?(u(!0),console.log(e,"TOKEN")):u(!1)}),[]),Object(i.jsxs)("div",{children:[Object(i.jsx)("div",{children:r}),!0===d&&Object(i.jsx)("button",{onClick:function(){localStorage.setItem("token",""),c("Log Out Successfull"),u(!1)},children:"Logout"})]})}),T.dataset),T),u()},9:function(e,t,o){}},[[12,1,2]]]);
//# sourceMappingURL=main.0d96682e.chunk.js.map